filter {
  if [type] == "dataheadsvc" {
    grok {
      match => { "message" => "^%{TIMESTAMP_ISO8601:timestamp}%{SPACE}(?<thread_name>\[(.*?)\])%{SPACE}%{LOGLEVEL:log_level}%{SPACE}%{JAVAFILE:file_name}%{SPACE}\(%{WORD}%{SPACE}%{NUMBER}\)%{SPACE}%{GREEDYDATA:log_message}" }
    }

    if [file_name] == "RequestLog.java" {
      grok {
        match => { "log_message" => "^%{IPORHOST:client_host} %{WORD:verb} %{DATA}//%{IPORHOST:server_host}(?::%{POSINT:server_port})?%{URIPATH:uri_path}(%{URIPARAM:uri_param})? %{DATA}/%{DATA} %{NUMBER:status:int} %{NUMBER:resp_time_ms:int} (?:%{NUMBER:bytes_ingress:int}|-) (?:%{NUMBER:bytes_egress:int}|-)( 'X-Forwarded-For: %{IPORHOST:client_host'})?%{DATA}" }
          add_tag => [ "request_log" ]
          overwrite => ["client_host" ]
      }
      mutate {
        replace => { type => "accesslog" }
      }
    }
    date {
      match => [ "timestamp" , "ISO8601" ]
    }
      
    mutate {
      remove_field => [ "timestamp" ]
      remove_field => [ "log_message" ]
    }
  }
}

